on_startup_great_projects_effect = {
	if = {
		limit = {
			NOT = { has_dlc = "Leviathan" }
		}
		226 = {
			add_province_modifier = {
				name = city_watch_no_dlc
				duration = -1
			}
		}
	}
	if = {
		limit = {
			NOT = { has_dlc = "Leviathan" }
		}
		27 = {
			add_province_triggered_modifier = great_sept_of_baelor
		}
	}
}

on_yearly_pulse_spawn_clear_bandits_effect = {
	# Spawn in Bandits
	random_owned_province = {
		limit = {
			unrest = 6
			has_no_criminal_activity = { type = bandits }
		}
		province_event = { id = banditry.1 }
	}
	# Clear Bandits
	random_owned_province = {
		limit = {
			NOT = { current_crime_lvl = { amount = 5 } }
			has_criminal_activity = { type = bandits }
		}
		province_event = { id = banditry.2 }
	}
}

on_yearly_pulse_bandits_events_effect = {
	random_owned_province = {
		limit = { has_criminal_activity = { type = bandits } }
		random_list = {
			20 = {
				trigger = {
					NOT = { has_province_modifier = public_square_raided }
				}
				province_event = { id = banditry.11 }
			}
			10 = {
				trigger = {
					NOT = { has_province_modifier = town_hearths_raided }
				}
				modifier = {
					factor = 2
					development = 10
				}
				province_event = { id = banditry.12 }
			}
			10 = {
				trigger = {
					NOT = { has_province_modifier = city_granaries_raided }
					has_building = food_silo
				}
				province_event = { id = banditry.13 }
			}
			10 = {
				trigger = {
					has_port = yes
					NOT = { has_province_modifier = city_port_raided }
				}
				modifier = {
					factor = 2
					base_production = 4
				}
				modifier = {
					factor = 0
					has_any_navy_building = yes
				}
				province_event = { id = banditry.14 }
			}
			10 = {
				trigger = {
					NOT = { has_province_modifier = trade_route_raided }
				}
				modifier = {
					factor = 2
					province_trade_power = 5
				}
				modifier = {
					factor = 2
					province_trade_power = 10
				}
				province_event = { id = banditry.15 }
			}
			20 = {
				trigger = { current_crime_lvl = { amount = 15 } }
				modifier = {
					factor = 2
					current_crime_lvl = { amount = 25 }
				}
				modifier = {
					factor = 4
					current_crime_lvl = { amount = 40 }
				}
				save_event_target_as = banditprovince
				random_neighbor_province = {
					limit = { owned_by = ROOT }
					province_event = { id = banditry.16 }
				}
			}
			20 = {
				trigger = { current_crime_lvl = { amount = 25 } }
				modifier = {
					factor = 4
					current_crime_lvl = { amount = 50 }
				}
				save_event_target_as = banditprovince
				random_neighbor_province = {
					limit = { owned_by = ROOT }
					province_event = { id = banditry.17 }
				}
			}
		}
	}
}

# Province
on_province_owner_change_government_effect = {
	if = {
		limit = {
			owner = {
				has_government_attribute = cheaper_developing_pastures
			}
			OR = {
				has_terrain = farmlands
				has_terrain = grasslands
			}
		}
		add_province_modifier = {
			name = cheaper_pasturelands_development
			duration = -1
			#hidden = yes
		}
	}
	if = {
		limit = {
			owner = { has_government_attribute = temples_modifier }
			has_any_taxation_building = yes
		}
		add_province_modifier = {
			name = gov_expanded_temple_rights_mod
			duration = -1
		}
	}
}

on_war_ended_scripted_effect = {
	# Ensure that if a feudatory rises up but fails, they
	# become a feudatory again instead of a regular vassal
	if = {
		limit = {
			westeros_government_great_house = yes
			FROM = {
				is_subject_of_type_with_overlord = {
					who = ROOT
					type = vassal
				}
			}
		}
		create_subject = {
			subject_type = feudatory
			subject = FROM
		}
	}

	# Used for 'Usurp Overlord' casus belli aftermath
	on_war_ended_usurp_overlord_effect = yes
}

# Used for 'Usurp Overlord' casus belli aftermath
on_war_ended_usurp_overlord_effect = {
	if = {
		limit = {
			NOT = { FROM = { is_subject_of = ROOT } }
			NOT = { ROOT = { is_subject_of = FROM } }
		}
		feudatory_assignment_effect = { country_tag = ROOT }
		feudatory_assignment_effect = { country_tag = FROM }
	}

	# KEEP AT THE BOTTOM
	original_overlord_flag_clear_effect = yes
	FROM = { original_overlord_flag_clear_effect = yes }
}

# Used for 'Usurp Overlord' casus belli aftermath
original_overlord_flag_clear_effect = {
	if = {
		limit = {
			has_country_flag = orgOverlord_TheNorth
		}
		clr_country_flag = orgOverlord_TheNorth
	}
	else_if = {
		limit = {
			has_country_flag = orgOverlord_TheRiverlands
		}
		clr_country_flag = orgOverlord_TheRiverlands
	}
	else_if = {
		limit = {
			has_country_flag = orgOverlord_TheVale
		}
		clr_country_flag = orgOverlord_TheVale
	}
	else_if = {
		limit = {
			has_country_flag = orgOverlord_TheWesterlands
		}
		clr_country_flag = orgOverlord_TheWesterlands
	}
	else_if = {
		limit = {
			has_country_flag = orgOverlord_TheStormlands
		}
		clr_country_flag = orgOverlord_TheStormlands
	}
	else_if = {
		limit = {
			has_country_flag = orgOverlord_TheReach
		}
		clr_country_flag = orgOverlord_TheReach
	}
	else_if = {
		limit = {
			has_country_flag = orgOverlord_Dorne
		}
		clr_country_flag = orgOverlord_Dorne
	}
	else_if = {
		limit = {
			has_country_flag = orgOverlord_TheIronIslands
		}
		clr_country_flag = orgOverlord_TheIronIslands
	}
	
}

# Used for 'Usurp Overlord' casus belli aftermath
feudatory_assignment_effect = {
	$country_tag$ = {
		if = {
			limit = { has_country_flag = orgOverlord_TheNorth }
			clr_country_flag = orgOverlord_TheNorth
			event_target:TheNorthGreatHouse = {
				create_subject = {
					subject_type = feudatory
					subject = $country_tag$
				}
			}
		}
		else_if = {
			limit = { has_country_flag = orgOverlord_TheRiverlands }
			clr_country_flag = orgOverlord_TheRiverlands
			event_target:TheRiverlandsGreatHouse = {
				create_subject = {
					subject_type = feudatory
					subject = $country_tag$
				}
			}
		}
		else_if = {
			limit = { has_country_flag = orgOverlord_TheVale }
			clr_country_flag = orgOverlord_TheVale
			event_target:TheValeGreatHouse = {
				create_subject = {
					subject_type = feudatory
					subject = $country_tag$
				}
			}
		}
		else_if = {
			limit = { 	has_country_flag = orgOverlord_TheWesterlands }
			clr_country_flag = orgOverlord_TheWesterlands
			event_target:TheWesterlandsGreatHouse = {
				create_subject = {
					subject_type = feudatory
					subject = $country_tag$
				}
			}
		}
		else_if = {
			limit = { has_country_flag = orgOverlord_TheStormlands }
			clr_country_flag = orgOverlord_TheStormlands
			event_target:TheStormlandsGreatHouse = {
				create_subject = {
					subject_type = feudatory
					subject = $country_tag$
				}
			}
		}
		else_if = {
			limit = { has_country_flag = orgOverlord_TheReach }
			clr_country_flag = orgOverlord_TheReach
			event_target:TheReachGreatHouse = {
				create_subject = {
					subject_type = feudatory
					subject = $country_tag$
				}
			}
		}
		else_if = {
			limit = { has_country_flag = orgOverlord_Dorne }
			clr_country_flag = orgOverlord_Dorne
			event_target:DorneGreatHouse = {
				create_subject = {
					subject_type = feudatory
					subject = $country_tag$
				}
			}
		}
		else_if = {
			limit = { has_country_flag = orgOverlord_TheIronIslands }
			clr_country_flag = orgOverlord_TheIronIslands
			event_target:TheIronIslandsGreatHouse = {
				create_subject = {
					subject_type = feudatory
					subject = $country_tag$
				}
			}
		}
	}
}